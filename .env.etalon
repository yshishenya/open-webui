# Copy this file to `.env` and fill in values as needed.
# Never commit `.env`.

####################################
# Docker Compose / Deployment
####################################

# Public port for the web UI (docker-compose.yaml maps this -> container:8080)
OPEN_WEBUI_PORT=3000

# Optional image tag override (docker-compose.yaml default: main)
WEBUI_DOCKER_TAG=main
# Optional image repository override (docker-compose.prod.yml)
WEBUI_IMAGE=yshishenya/yshishenya

# Postgres (docker-compose.yaml)
POSTGRES_DB=airis
POSTGRES_USER=airis
POSTGRES_PASSWORD=airis_secure_password_2024
POSTGRES_PORT=5432

# Optional explicit DB URL override.
# - With docker-compose, use host `postgres` (service name) or an external hostname.
# - When running backend locally (non-docker), use host `localhost` (or your DB host).
DATABASE_URL=postgresql://airis:airis_secure_password_2024@postgres:5432/airis

# Security (required when WEBUI_AUTH=true)
WEBUI_AUTH=true
# Generate a strong secret, e.g.:
# python -c 'import secrets; print(secrets.token_hex(32))'
WEBUI_SECRET_KEY='f3d14ec57769cf0f35575cc526fc5c1f48c5a2d02cfc354591d061ac72abc0ed'

# Optional canonical base URL (some backend features use it)
WEBUI_URL=

# Optional Redis (recommended for features like OAuth state, rate limiting, tasks)
REDIS_URL=

####################################
# Providers
####################################

# Ollama URL for the backend to connect
# The path '/ollama' will be redirected to the specified backend URL
OLLAMA_BASE_URL='http://localhost:11434'

# OpenAI (optional; can also be configured in the UI)
OPENAI_API_BASE_URL=''
OPENAI_API_KEY=''

# AUTOMATIC1111_BASE_URL=http://localhost:7860

####################################
# Compose overlays (optional)
####################################

# docker-compose.api.yaml (expose Ollama API)
OLLAMA_WEBAPI_PORT=11434

# docker-compose.data.yaml (persist Ollama data)
OLLAMA_DATA_DIR=./ollama-data

# docker-compose.gpu.yaml (GPU settings used by scripts/run-compose.sh)
OLLAMA_GPU_DRIVER=nvidia
OLLAMA_GPU_COUNT=1

# docker-compose.amdgpu.yaml (AMD ROCm tweak; advanced)
HSA_OVERRIDE_GFX_VERSION=11.0.0

# docker-compose.amdgpu.yaml / ollama image tag (default: latest / rocm)
OLLAMA_DOCKER_TAG=latest

# docker-compose.dev.yaml (dev overlay ports)
OPEN_WEBUI_API_PORT=8080
AIRIS_FRONTEND_PORT=5173

####################################
# Networking / Telemetry
####################################

# For production, you should only need one host as fastapi serves the built frontend + backend.
# For local CORS testing, you can set something like:
# CORS_ALLOW_ORIGIN=http://localhost:5173;http://localhost:8080
CORS_ALLOW_ORIGIN='*'

# For production you should set this to match the proxy configuration (127.0.0.1)
FORWARDED_ALLOW_IPS='*'

SCARF_NO_ANALYTICS=true
DO_NOT_TRACK=true
ANONYMIZED_TELEMETRY=false

####################################
# OAuth (login providers)
####################################

# Toggle whether OAuth can auto-create users (login for existing users still works).
ENABLE_OAUTH_SIGNUP=true
OAUTH_MERGE_ACCOUNTS_BY_EMAIL=true

# GitHub OAuth (shown on /auth when both are set)
GITHUB_CLIENT_ID=Ov23ligdOsElwafrX87U
GITHUB_CLIENT_SECRET=cbb3b975bf19f0638fde013cc34fa572884dc979
GITHUB_CLIENT_SCOPE=user:email
# Leave empty to auto-generate callback URL: /oauth/github/login/callback
GITHUB_CLIENT_REDIRECT_URI=https://airis.2brain.pro/oauth/github/login/callback

# VK OAuth
VK_CLIENT_ID='54402052'
VK_CLIENT_SECRET='KttYso0TEUe4fzAdrSBi'
# IMPORTANT: Must match the callback/redirect URL configured in your VK app.
# - VK ID SDK widget (default when VK_CLIENT_ID is set): usually your public origin (e.g. https://airis.example.com)
# - Legacy VK OAuth endpoints (/api/v1/oauth/vk/login): https://<domain>/api/v1/oauth/vk/callback
VK_REDIRECT_URI='https://airis.2brain.pro'
VK_OAUTH_SCOPE=email
VK_API_VERSION=5.131

# Yandex OAuth
YANDEX_CLIENT_ID='28b419103bd943edbcae0b391705a44b  '
YANDEX_CLIENT_SECRET='4e62c96f213a4bdba5c69e7026c6126f'
YANDEX_REDIRECT_URI='https://chat.airis.you/api/v1/oauth/yandex/callback'
YANDEX_OAUTH_SCOPE=login:email login:info login:avatar

# Telegram authentication (Telegram Login Widget)
ENABLE_TELEGRAM_AUTH=true
# Bot username (with or without leading `@`). For backward compatibility some flows use TELEGRAM_BOT_NAME.
TELEGRAM_BOT_USERNAME=@airis_auth_bot
# TELEGRAM_BOT_TOKEN is a secret. Do not commit it, expose it to clients, or log it.
TELEGRAM_BOT_TOKEN=7880245614:AAGfU-cEgNi8eOusDkA9wDyt_wLIMDuzX94
# Legacy/compat (some older flows): bot username
TELEGRAM_BOT_NAME=@airis_auth_bot
# Optional legacy origin (some older flows)
TELEGRAM_AUTH_ORIGIN=
TELEGRAM_AUTH_MAX_AGE_SECONDS=600
ENABLE_TELEGRAM_SIGNUP=true

####################################
# Email (SMTP) - optional
####################################

# Used to build verification/reset links in emails
FRONTEND_URL="https://chat.airis.you"

SMTP_HOST="smtp.yandex.com"
SMTP_PORT="587"
SMTP_USERNAME="yan@shishenya.ru"
SMTP_PASSWORD="MaX0027093+"          # пароль приложения/SMTP
SMTP_USE_TLS="true"
SMTP_FROM_EMAIL="yan@shishenya/.ru"
SMTP_FROM_NAME="Airis"

####################################
# Billing / YooKassa
####################################

ENABLE_BILLING_WALLET=true
ENABLE_BILLING_SUBSCRIPTIONS=false
LEAD_MAGNET_ENABLED=true
LEAD_MAGNET_CYCLE_DAYS=30
LEAD_MAGNET_QUOTAS='{"tokens_input":1000000,"tokens_output":1000000,"images":100,"tts_seconds":3600,"stt_seconds":3600}'

BILLING_DEFAULT_CURRENCY=RUB
BILLING_RATE_CARD_VERSION=2025-01
BILLING_HOLD_TTL_SECONDS=900
BILLING_ESTIMATE_MAX_OUTPUT_TOKENS=512
BILLING_MAX_DAILY_SPEND_DEFAULT_KOPEKS=0
BILLING_GRACE_PERIOD_DAYS=3
BILLING_TOPUP_TTL_DAYS=365
BILLING_TOPUP_PACKAGES_KOPEKS=100000,150000,500000,1000000

# Fiscal receipts (54-FZ / YooKassa)
# Важно: если в вашем магазине включена фискализация, чек (`receipt`) должен уходить в каждом платеже.
BILLING_RECEIPT_ENABLED=true
# Код НДС (по справочнику YooKassa): 1=без НДС, 2=НДС 10%, 3=НДС 20%, 4=10/110, 5=20/120, 6=НДС 0%.
BILLING_RECEIPT_VAT_CODE=1
# Способ расчета (payment_mode), например: full_payment, full_prepayment, prepayment, advance, partial_payment, credit, credit_payment.
BILLING_RECEIPT_PAYMENT_MODE=full_payment
# Предмет расчета (payment_subject), например: service, payment, commodity, job, agent_commission.
BILLING_RECEIPT_PAYMENT_SUBJECT=service
# Система налогообложения (1..6), если требуется вашей схемой фискализации. Иначе оставьте пустым.
BILLING_RECEIPT_TAX_SYSTEM_CODE=

PUBLIC_PRICING_POPULAR_MODELS=
PUBLIC_PRICING_RECOMMENDED_TEXT_MODEL=
PUBLIC_PRICING_RECOMMENDED_IMAGE_MODEL=
PUBLIC_PRICING_RECOMMENDED_AUDIO_MODEL=
PUBLIC_PRICING_RATE_CARD_MODEL_LIMIT=50

YOOKASSA_SHOP_ID=''
YOOKASSA_SECRET_KEY=''
YOOKASSA_WEBHOOK_SECRET=''
# Optional extra protection for the webhook endpoint (shared secret in URL):
#   https://<your-host>/api/v1/billing/webhook/yookassa?token=<secret>
YOOKASSA_WEBHOOK_TOKEN=
# Optional webhook hardening (recommended if your app receives webhooks directly from YooKassa):
# - Enable source IP allowlist verification against YooKassa documented IP ranges.
# - If you run behind a reverse proxy, enable TRUST_X_FORWARDED_FOR and ensure only the proxy
#   can reach the app (otherwise X-Forwarded-For can be spoofed).
YOOKASSA_WEBHOOK_ENFORCE_IP_ALLOWLIST=false
YOOKASSA_WEBHOOK_TRUST_X_FORWARDED_FOR=false
# Optional: extra allowed CIDRs/IPs (comma-separated), in addition to YooKassa default list.
YOOKASSA_WEBHOOK_ALLOWED_IP_RANGES=
YOOKASSA_API_URL=https://api.yookassa.ru/v3
