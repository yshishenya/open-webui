# Pricing page (“Тарифы”): анализ ТЗ + JTBD + комментарии

## Meta

- Type: docs
- Status: done
- Owner: Codex
- Branch: docs/pricing-page-tariffs-analysis
- Created: 2026-02-05
- Updated: 2026-02-05

## Context

Коллегой подготовлено текстовое ТЗ на страницу «Тарифы» (несколько “экранов” в рамках одной страницы):
оплата по использованию (кошелёк), фиксированные суммы пополнения, таблица ставок по моделям, объяснение
токенов, блок про модерацию, FAQ.

В репозитории уже есть публичная `/pricing` с динамическим Rate Card и конфигом (top-up суммы, free limits,
popular/recommended models). Нужно:

1) маппить новое ТЗ на существующую страницу/компоненты,
2) выявить пробелы и потенциальные риски (особенно “модерация” и формулировки),
3) предложить улучшения структуры/копирайта/UX и уточняющие вопросы.

## Goal / Acceptance Criteria

- [x] Дать JTBD-разбор: jobs → что должно быть на странице.
- [x] Провести критический обзор ТЗ (пробелы, дубли, риски формулировок).
- [x] Оценить техническую реализуемость в текущем стеке (что уже есть, что потребует доработок).
- [x] Сформировать рекомендацию по структуре страницы и приоритизацию (Must/Should/Could).
- [x] Список вопросов, которые нужно закрыть перед внедрением.

## Non-goals

- Не вносить изменения в код/дизайн в рамках этого work item.
- Не внедрять модерацию/блокировки пользователей (только оценка и требования).

## JTBD (Jobs To Be Done)

### Основные “jobs” посетителя страницы

1) **Оценить** “сколько примерно будет стоить” до регистрации/оплаты.
2) **Понять механику** оплаты: пополнение → списания → где смотреть историю → что будет при нуле.
3) **Снизить тревожность**: нет подписки/скрытых платежей, есть контроль расходов.
4) **Сравнить модели** по цене/модальности (и понять “ввод/ответ”).
5) **Разобраться в единицах** (токены / 1 000 токенов / 1 000 символов / минута / изображение).
6) **Понять ограничения** (free limits, возможные отклонения запросов политиками провайдеров, “модерация”).

### Ожидаемые outcomes (что пользователь должен унести)

- “Я понял, **как** платить и **за что** списывается”.
- “Я вижу **реальные ставки** и могу прикинуть бюджет”.
- “Я не боюсь ‘случайно потратить много’, есть контроль”.
- “Я понимаю разницу ‘ввод/ответ’, и почему контекст влияет на цену”.

## Gap analysis: ТЗ коллеги vs текущая /pricing

### Уже закрыто текущей реализацией

- Hero: “оплата по использованию, без подписки”, CTA guest/authed.
- “Как устроена оплата” + показ фиксированных сумм пополнения.
- Estimator (примерная оценка затрат) — в ТЗ это не отдельно выделено, но закрывает ключевой job.
- Free start: “начать бесплатно без карты” + лимиты/цикл.
- Rates table: динамические ставки по моделям (Rate Card), фильтр/поиск.
- “Как считается стоимость” (коротко) + FAQ (в т.ч. VPN, ввод/ответ, история списаний).

### Не хватает / требует уточнения

- **Экран “Что такое токен?”**: сейчас токены упоминаются в таблице и калькуляторе, но нет объясняющего блока.
- **Модерация контента**: в коде нет явной системы “обязательной модерации” per-model + блокировок. ТЗ
  формулирует сильные обещания (автопроверка каждого запроса, блокировка “без восстановления”).
- **Видео-генерация**: в публичном Rate Card сейчас нет модальности “video”, UI не показывает ставки за секунду.
- Уточнить “контроль списаний”: в продукте есть дополнительные механизмы (лимит стоимости ответа, дневной лимит,
  auto-topup) — их можно использовать как успокаивающие элементы.

## 6 шляп (De Bono) — комментарии к ТЗ

### Белая (факты)

- Страница `/pricing` уже реализована и питается от публичных API:
  - public rate cards (до 50 моделей; text/image/tts/stt),
  - public pricing config (topup суммы, free limits, popular/recommended ids),
  - public lead magnet config (цикл/квоты).
- Фиксированные суммы пополнения уже конфигурируются через env (в копейках), а на странице показываются в ₽.
- Таблица ставок уже показывает “ввод/ответ” как отдельные цены (за 1k).

### Красная (ощущения пользователя)

- Сильный плюс: “без подписки” и “начать бесплатно” — снижает барьер.
- Сильный риск: “модерация” и “блокировка без восстановления” могут пугать и снижать конверсию, если это
  вынесено слишком рано/жёстко.
- Длинные объяснения токенов/контекста в середине страницы могут перегрузить — лучше progressive disclosure
  (accordion/“узнать больше”).

### Чёрная (риски)

- **Точность формулировок**: нельзя обещать “автопроверку каждого запроса” и конкретные санкции, если механизма
  нет или он отличается.
- **Копирование конкурента**: “скопировать gptunnel” — риск по авторским правам/бренд-ассоциациям. Лучше
  воспроизвести структуру/UX, но контент и таблицу строить из наших данных (Rate Card).
- **Единицы**: “1 000 знаков” vs “1 000 символов” vs “токены” — нужно единообразие, иначе поддержку завалят
  вопросами.
- **Видео**: если на странице появится “видео за секунду”, а продукта нет — будет разрыв ожиданий.

### Жёлтая (плюсы/возможности)

- ТЗ хорошо покрывает прозрачность: “за что списывается” + “где смотреть историю”.
- Отдельный блок “что такое токен” заметно снижает нагрузку на поддержку.
- Модерация/правила (в корректной форме) повышают доверие и снижает риск abuse/банов у провайдеров.

### Зелёная (идеи)

- Добавить “**Контроль расходов**” в “Как устроена оплата”: лимит на стоимость ответа и дневной лимит (как
  анти-тревожность).
- Блок “Что такое токен” сделать **кратким** + “подробнее” (2 уровня).
- Модерацию вынести в “FAQ/Безопасность” и формулировать как:
  - “некоторые модели/провайдеры могут отклонять запросы по политике”,
  - “мы можем ограничить доступ при систематических нарушениях” (если реально планируется).
- Вместо “видео” — “другие модальности могут появиться позже” (без цен).

### Синяя (управление/что дальше)

1) Зафиксировать, что страница — **одна** (скролл), а не реальные “экраны”.
2) Выбрать точную версию текста про токены/контекст (коротко + детально).
3) Решить по модерации: “только информационный блок” vs “реальная модерация с enforcement” (это отдельный
   проект с backend+policy+UX).
4) После решений — обновить `/pricing` секции и добавить недостающие блоки.

## Рекомендованная структура страницы (секции)

1) Hero: “оплата по использованию” + CTA + суммы пополнения.
2) “Как устроена оплата” (3–4 пункта) + “контроль расходов”.
3) “Сколько это примерно стоит” (Estimator).
4) “Ставки по моделям” (таблица).
5) “Как считается стоимость” (коротко) + “Что такое токен?” (accordion).
6) “Безопасность и модерация” (accordion/FAQ, только проверенные обещания).
7) FAQ + финальный CTA.

## Проработка “по экранам” (ТЗ коллеги → рекомендуемая реализация)

Ниже — разбор каждого “экрана” как секции одной страницы `/pricing`.

### Экран 1 — Стоимость за использование сервиса (Hero)

**Задача (JTBD):** быстро объяснить “как платим” и дать два пути: начать бесплатно / пополнить баланс.

**Текущая реализация:** есть Hero с “оплата по использованию — без подписки”, CTA guest/authed, чипсы с суммами.

**Рекомендуемая версия копирайта (коротко):**
- Заголовок: «Оплата по использованию — без подписки»
- Подзаголовок: «Пополняете баланс — списания только когда пользуетесь. Бесплатный старт без карты.»
- CTA primary (гость): «Начать бесплатно»
- CTA secondary (гость): «Войти и пополнить»
- CTA primary (авториз.): «Пополнить баланс»
- CTA secondary (авториз.): «Перейти в чат»

**Комментарии:**
- Важно в первом экране закрепить “без подписки/ежемесячных платежей” и “контроль” (история списаний).
- Чипсы сумм пополнения хорошо работают как “якорь цены”, но без клика в оплату. Если хотим усилить конверсию —
  можно сделать кликабельные чипсы (вести в `/billing/balance` и подсвечивать выбранную сумму).

**Тех. заметка:** суммы пополнения уже берутся из `BILLING_TOPUP_PACKAGES_KOPEKS` (копейки → ₽).

### Экран 2 — Как устроена оплата (step-by-step)

**Задача:** снять страх “как списывается” и показать, что списания только при использовании и всё прозрачно.

**Текущая реализация:** есть карточка “Как устроена оплата” + повтор сумм пополнения.

**Рекомендуемая структура (4 шага как в ТЗ):**
1) «Пополните баланс на фиксированную сумму» (показываем чипсы 1000/1500/2000/3000/5000 ₽, если так решим)
2) «Списания — только при использовании»
3) «Контролируйте историю списаний в личном кабинете»
4) «Настройте лимиты расходов (по желанию)» *(если продукт это поддерживает, лучше как “опционально”)*

**Комментарии:**
- Шаг 4 из ТЗ “Оплачивайте только для использовании” — дублирует шаг 2. Лучше заменить на “лимиты/контроль”.
- Если хотим держать максимально простой месседж — шаг 4 можно убрать, а “лимиты” вынести в FAQ.

**Тех. заметка:** “личный кабинет” — это `/billing/balance` и `/billing/history` (история).

### Экран 3 — Сколько это стоит (принципы расчёта)

**Задача:** объяснить “единицы” для разных типов контента и почему стоимость текста зависит от объёма.

**Текущая реализация:** есть секция “Как считается стоимость”, но очень общая.

**Рекомендуемая версия (по смыслу ТЗ, но точнее и короче):**
- Текст: «Считаем отдельно ввод (весь контекст запроса) и ответ модели. Цена — за 1 000 токенов.»
- Изображения: «Цена — за 1 изображение (в таблице указан базовый размер).»
- Озвучка (TTS): «Цена — за 1 000 символов текста.»
- Распознавание (STT): «Цена — за 1 минуту аудио/видео.»
- Другие модальности: «Если появятся новые форматы — покажем их ставки в таблице.»

**Комментарии:**
- Про “весь контекст” важно: объяснить одной фразой и дать “узнать больше” (иначе перегруз).
- Не обещать “для других типов моделей принципы могут отличаться” без примеров: оставить как примечание.

**Тех. заметка:** публичный Rate Card сейчас покрывает text/image/tts/stt. Видео как отдельной модальности нет.

### Экран 4 — Генерация текста и другие модели (таблица ставок)

**Задача:** дать прозрачные ставки по моделям и быстрый путь “найти нужное”.

**Текущая реализация:** RatesTable уже делает то, что в ТЗ предлагается “скопировать с gptunnel”: поиск, фильтр,
популярные/все, ставки по модальностям.

**Комментарии:**
- Не копировать чужую страницу текстом/структурой 1-в-1. Достаточно сохранить паттерн “таблица ставок по моделям”,
  но построенную на наших `Rate Card` данных.
- Уточнить в заголовках единицы (ввод/ответ “за 1 000 токенов”), чтобы не было вопросов “за что списали”.
- Если хотим “пакетные” блоки как у конкурентов (“Текст / Изображения / Аудио”) — можно добавить быстрые якоря,
  которые переключают фильтр таблицы.

**Тех. заметка:** таблица берёт данные из `GET /api/v1/billing/public/rate-cards`.

### Экран 5 — Что такое токен?

**Задача:** снизить путаницу вокруг токенов и “ввода/ответа”, не перегрузив.

**Текущая реализация:** явного блока нет (токены подразумеваются в таблице/калькуляторе).

**Рекомендуемый UX (progressive disclosure):**
- Коротко (всегда видно): «Токены — это единицы текста, которые считает модель. В разных языках расход отличается.»
- “Подробнее” (accordion):
  - «1 000 токенов ≈ 700–800 английских слов (очень грубо).»
  - «В чате ввод включает весь контекст диалога, а ответ — только последнее сообщение модели.»
  - «Точное число зависит от модели и языка.»

**Комментарии:**
- В ТЗ есть числа про русский “1 символ ≈ 1 токен” — это риск завысить ожидания/страх. Лучше без точного
  коэффициента, только “в русском обычно больше токенов на тот же объём”.

### Экран 6 — Модерация контента (+ рекомендации)

**Задача:** прозрачно предупредить о правилах, но не создать страх и не пообещать то, чего нет.

**Текущая реализация:** явного блока/флага “модерация” на моделях сейчас не видно.

**Рекомендуемая версия для страницы сейчас (без непроверенных обещаний):**
- «Некоторые модели и провайдеры могут отклонять запросы, нарушающие правила (незаконный/вредный контент).»
- «Если запрос отклонён — переформулируйте его.»
- «Мы обязаны соблюдать правила провайдеров и наши условия использования.» *(линк на `/terms`)*

**Что нельзя писать без отдельной реализации:**
- “мы автоматически проверяем каждый запрос” (если реально не проверяем),
- “при повторных нарушениях доступ будет заблокирован без восстановления” (нужно policy + enforcement + логика).

**Если нужно как в ТЗ (с флагом “Модерация” и блокировками):** это отдельный проект:
- источник флага per-model,
- расширение public Rate Card API,
- enforcement в пайплайне запросов,
- UX ошибок и апелляций,
- юридическая база (оферта/политика).

### Экран 7 — Вопросы (FAQ)

**Задача:** снять типовые возражения и объяснить “нулевой баланс / история / VPN / ввод-ответ”.

**Текущая реализация:** FAQ уже покрывает 90% вопросов из ТЗ.

**Комментарии/добавления:**
- “Где смотреть историю” лучше назвать “История списаний” (связать с UI `/billing/history`).
- Добавить вопрос “Как контролировать расходы?” → “лимит стоимости ответа / дневной лимит” (если это в продукте).
- Не обещать “история написаний” — правильнее “история списаний/операций”.

## Technical feasibility notes

### Что уже есть (можно использовать)

- Публичные API для страницы `/pricing`:
  - `GET /api/v1/billing/public/pricing-config`
  - `GET /api/v1/billing/public/lead-magnet`
  - `GET /api/v1/billing/public/rate-cards`
- Конфиги (env):
  - `BILLING_TOPUP_PACKAGES_KOPEKS` → фиксированные суммы пополнения
  - `PUBLIC_PRICING_POPULAR_MODELS`, `PUBLIC_PRICING_RECOMMENDED_*`
  - Lead magnet quotas/цикл

### Что потребует отдельной разработки

- “Флаг модерации” per-model в публичной таблице ставок: нужно определить источник (Model.meta vs отдельная
  таблица/конфиг) и расширить public RateCard API.
- Реальная модерация запросов (если обещаем “автоматически проверяем каждый запрос”):
  - интеграция с модерацией провайдера / собственная классификация,
  - enforcement per-model/per-user,
  - UX: объяснимые ошибки, политика и апелляции,
  - логирование/аудит без утечек.
- Видео-генерация как отдельная модальность в Rate Card + биллинге (если в планах).

## Open questions (до финализации контента)

1) “Модерация”: мы действительно **проверяем** запросы до отправки в модель или речь о том, что провайдер
   иногда отклоняет? Какие санкции и где это прописано юридически?
2) Видео: есть ли в roadmap? Если нет — убираем из публичной страницы.
3) Единицы TTS: “знаки” vs “символы” — что считаем (в коде: chars/1000).
4) Нужна ли отдельная “API pricing” часть (для разработчиков) или страница строго про web-chat?
5) Нужно ли явно говорить про округление (до копейки, ceil) и минимальные списания?

## Upstream impact

- Upstream-owned files touched: none (docs-only).

## Verification

- Tests: N/A (docs-only)

## Task Entry (for branch_updates/current_tasks)

- [x] **[DOCS][PRICING]** Review ТЗ страницы тарифов (JTBD + 6 шляп + тех. гэпы)
  - Spec: `meta/memory_bank/specs/work_items/2026-02-05__docs__pricing-page-tariffs-tz-review.md`
  - Owner: Codex
  - Branch: `docs/pricing-page-tariffs-analysis`
  - Done: 2026-02-05
  - Summary: Маппинг ТЗ на текущую `/pricing`, выявление гэпов (токены/модерация/видео) и рекомендации по структуре/копирайту.
  - Tests: N/A (docs-only)
  - Risks: Нельзя обещать модерацию/enforcement без реальной реализации и юр. текста.

## Risks / Rollback

- Risks:
  - Непроверенные формулировки про модерацию создадут юридический/репутационный риск.
  - Упоминание видео приведёт к завышенным ожиданиям.
- Rollback plan:
  - Для текста/страницы: откатить копирайт до текущей спецификации `/pricing` и убрать спорные блоки.
