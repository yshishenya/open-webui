# План: удалить прогноз стоимости перед отправкой

## Контекст

Пользователь не видит пользу в UI-прогнозе стоимости перед отправкой и просит убрать функциональность, чтобы не усложнять код. При этом серверный preflight/hold остается, чтобы исключить перерасход средств (запросы блокируются при недостатке баланса).

## Цели

- Убрать UI-прогноз стоимости в чате.
- Удалить публичный API-метод и типы, которые обслуживают UI-прогноз.
- Удалить endpoint `/api/v1/billing/estimate` на бэке.
- Не трогать механики preflight/hold в биллинге.
- Не трогать публичный калькулятор на `/pricing`.

## Невходит

- Изменения в preflight/hold, списании, lead magnet, rate card, авто-пополнении.
- Изменения в public pricing estimator (`src/lib/components/pricing/Estimator.svelte`).

## План работ

1. Frontend: удалить UI-прогноз и вызовы estimate в чате.
   - `src/lib/components/chat/MessageInput.svelte`: убрать state/таймеры, вызов `getEstimate`, форматирование и отображение чипа прогноза.
   - Проверить, что связанных импортов больше нет.
2. Frontend API: убрать estimate типы и метод.
   - `src/lib/apis/billing/index.ts`: удалить `EstimateRequest`, `EstimateResponse`, `getEstimate`.
3. Backend: удалить endpoint для UI-прогноза.
   - `backend/open_webui/routers/billing.py`: удалить `/api/v1/billing/estimate` и связанные модели запроса/ответа (если не используются в других местах).
4. Тесты: удалить/обновить тесты, которые завязаны на `/api/v1/billing/estimate`.
5. Проверка: убедиться, что preflight/hold остается и запросы по-прежнему блокируются при нехватке баланса.

## Риски и меры

- Риск: удалить используемые типы/модели, которые нужны в других местах.
  - Мера: проверка импорта и сборки TypeScript.
- Риск: оставить неиспользуемые импорты/переменные.
  - Мера: точечная чистка при удалении блока логики.

## Критерии готовности

- UI-прогноз в чате отсутствует.
- Нет endpoint `/api/v1/billing/estimate` и связанных типов в API клиента.
- Сборка фронтенда/линтер не ругается на неиспользуемые импорты.
- Серверный preflight/hold продолжает блокировать запросы при недостатке средств.
